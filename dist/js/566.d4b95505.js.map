{"version":3,"file":"js/566.d4b95505.js","mappings":"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","sources":["webpack://metawall/./src/views/Account.vue","webpack://metawall/./src/views/Account.vue?727f"],"sourcesContent":["<template>\n  <div class=\"account\">\n    <VForm v-slot=\"{ errors }\" @submit=\"updated\">\n      <!-- 頭像 -->\n      <div class=\"user-photo border circle\">\n        <img @load=\"successLoadImg\" :src=\"user.photo\" alt=\"\" class=\"hide\" />\n      </div>\n      <!-- 上傳按鈕 -->\n      <div class=\"upload-wrapper\">\n        <label for=\"uploadImage\" class=\"upload btn radius\">\n          上傳大頭照\n          <VField\n            id=\"uploadImage\"\n            name=\"uploadImage\"\n            type=\"file\"\n            class=\"hide\"\n            @change=\"upload(errors)\"\n            :rules=\"{ ext: ['jpg', 'png', 'jpeg'] }\"\n          />\n        </label>\n        <error-message name=\"uploadImage\">\n          <div class=\"error-message\">圖片格式錯誤，僅限 JPG、PNG 圖片</div>\n        </error-message>\n        <div v-if=\"errMessage\" class=\"error-message\">{{ errMessage }}</div>\n      </div>\n      <!-- 暱稱 -->\n      <label for=\"name\" class=\"name-wrapper\">\n        <div class=\"title\">暱稱</div>\n        <VField\n          id=\"name\"\n          name=\"暱稱\"\n          v-model=\"user.name\"\n          placeholder=\"輸入您的暱稱\"\n          class=\"name border\"\n          :rules=\"{ required: true, min: 2, max: 13 }\"\n        />\n        <error-message class=\"error-message\" name=\"暱稱\" />\n      </label>\n      <!-- 性別 -->\n      <div class=\"sex-wrapper\">\n        <div class=\"title\">性別</div>\n        <label for=\"male\" class=\"radio-wrapper\">\n          <input type=\"radio\" id=\"male\" v-model=\"user.sex\" value=\"male\" class=\"radio\" />\n          <span class=\"radio-button\"></span>\n          男性\n        </label>\n        <label for=\"female\" class=\"radio-wrapper\">\n          <input type=\"radio\" id=\"female\" v-model=\"user.sex\" value=\"female\" class=\"radio\" />\n          <span class=\"radio-button\"></span>\n          女性\n        </label>\n      </div>\n      <!-- 送出按鈕 -->\n      <button type=\"submit\" class=\"btn border submit\" :disabled=\"disabled(errors)\">送出更新</button>\n    </VForm>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'AccountView',\n  data() {\n    return {\n      user: {\n        photo: '',\n        name: '',\n        sex: '',\n      },\n      errMessage: '',\n    };\n  },\n  computed: {\n    tempUser() {\n      const { user } = this.$store.state;\n      return user;\n    },\n    compare() {\n      const { tempUser } = this;\n      const { user } = this;\n      const compare = [\n        user.photo !== tempUser.photo,\n        user.name !== tempUser.name,\n        user.sex !== tempUser.sex,\n      ].includes(true);\n      return compare;\n    },\n  },\n  watch: {\n    tempUser: {\n      handler() {\n        const user = this.tempUser;\n        this.user = {\n          photo: user.photo,\n          name: user.name,\n          sex: user.sex || 'male',\n        };\n      },\n      deep: true,\n      immediate: true,\n    },\n  },\n  methods: {\n    async upload(errors) {\n      this.errMessage = '';\n      if (errors.uploadImage === undefined) {\n        this.$store.commit('Load', true);\n        const uploadedFile = document.getElementById('uploadImage').files[0];\n        const formData = new FormData();\n        formData.append('file-to-upload', uploadedFile);\n        const api = `${process.env.VUE_APP_API}/upload/avatar`;\n        const { headers } = this.$store.state;\n        this.$http\n          .post(api, formData, headers)\n          .then((res) => {\n            const { imgUrl } = res.data;\n            this.user.photo = imgUrl;\n          })\n          .catch((err) => {\n            this.errMessage = err.response.data.message;\n          })\n          .then(() => {\n            this.$store.commit('Load', false);\n          });\n      }\n    },\n    updated() {\n      this.$store.commit('Load', true);\n      const api = `${process.env.VUE_APP_API}/user/profile`;\n      const { headers } = this.$store.state;\n      const data = {};\n      const { tempUser } = this;\n      const newUser = this.user;\n      if (newUser.name !== tempUser.name) data.name = newUser.name;\n      if (\n        // eslint-disable-next-line operator-linebreak\n        newUser.photo !== tempUser.photo &&\n        newUser.photo !== `${process.env.VUE_APP_USER_PHOTO}`\n      ) {\n        data.photo = newUser.photo;\n      }\n      if (newUser.sex !== tempUser.sex) data.sex = newUser.sex;\n\n      this.$http\n        .patch(api, data, headers)\n        .then((res) => {\n          const { user } = res.data;\n          delete user.followers;\n          delete user.following;\n          if (user.photo === '') user.photo = `${process.env.VUE_APP_USER_PHOTO}`;\n\n          this.$store.commit('user', user);\n          this.$swal({\n            title: '資料已更新',\n            icon: 'success',\n            customClass: {\n              actions: 'customize',\n              icon: 'customize',\n            },\n          });\n        })\n        .catch((err) => {\n          console.error(err);\n        })\n        .then(() => {\n          this.$store.commit('Load', false);\n        });\n    },\n    disabled(errors) {\n      const err = Object.keys(errors).length;\n      if (this.user.name && err === 0 && this.compare) return false;\n      return true;\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.user-photo {\n  margin: 0 auto 1rem auto;\n  width: 6.75rem;\n  height: 6.75rem;\n}\n\n.upload-wrapper {\n  margin-bottom: 1rem;\n  .error-message {\n    text-align: center;\n  }\n}\n\n.upload {\n  margin: 0 auto;\n  padding: 0.25rem 2rem;\n  width: fit-content;\n\n  background: $black;\n\n  color: $white;\n  line-height: 1.5em;\n  &:hover {\n    background: $blue-dark;\n  }\n}\n\n.title {\n  margin-bottom: 0.25rem;\n}\n\n.name-wrapper {\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 1rem;\n  .border {\n    padding: 0.75rem 1rem;\n  }\n}\n\n.sex-wrapper {\n  margin-bottom: 2rem;\n}\n\n.radio-wrapper {\n  display: inline-flex;\n  align-items: center;\n  &:not(:last-child) {\n    margin-right: 1.5rem;\n  }\n}\n\n.radio {\n  display: none;\n  &:checked ~ .radio-button::after {\n    opacity: 1;\n  }\n}\n\n.radio-button {\n  position: relative;\n  margin-right: 0.75rem;\n  width: 1.25rem;\n  height: 1.25rem;\n\n  border: 2px solid $black;\n  border-radius: 50%;\n}\n\n.radio-button::after {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  display: block;\n  width: 0.625rem;\n  height: 0.625rem;\n\n  border-radius: 50%;\n  background-color: $black;\n\n  content: '';\n\n  opacity: 0;\n  transition: $transition-1;\n  transform: translate(-50%, -50%);\n}\n\n.error-message {\n  margin-top: 0.25rem;\n\n  color: $pink;\n  text-align: start;\n\n  font-size: 0.875rem;\n}\n</style>\n","import { render } from \"./Account.vue?vue&type=template&id=3d879ac3&scoped=true\"\nimport script from \"./Account.vue?vue&type=script&lang=js\"\nexport * from \"./Account.vue?vue&type=script&lang=js\"\n\nimport \"./Account.vue?vue&type=style&index=0&id=3d879ac3&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\User\\\\Documents\\\\GitHub\\\\metawall\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3d879ac3\"]])\n\nexport default __exports__"],"names":["class","for","_createElementVNode","_createElementBlock","_createVNode","_component_VForm","onSubmit","$options","errors","onLoad","_ctx","src","$data","photo","alt","_component_VField","id","name","type","onChange","rules","ext","_component_error_message","_hoisted_7","_toDisplayString","_hoisted_10","$event","placeholder","required","min","max","_hoisted_12","sex","value","_hoisted_14","_hoisted_17","disabled","_hoisted_19","data","user","errMessage","computed","tempUser","this","$store","state","compare","includes","watch","handler","deep","immediate","methods","async","undefined","uploadImage","commit","uploadedFile","document","getElementById","files","formData","FormData","append","api","headers","$http","post","then","res","imgUrl","catch","err","response","message","updated","newUser","patch","followers","following","$swal","title","icon","customClass","actions","console","error","Object","keys","length","__exports__","render"],"sourceRoot":""}