{"version":3,"file":"js/304.70d5b50f.js","mappings":"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","sources":["webpack://metawall/./src/views/Profile.vue","webpack://metawall/./src/views/Profile.vue?24e8"],"sourcesContent":["<template>\n  <div class=\"profile\">\n    <div class=\"header-wrapper\">\n      <div class=\"header border bg-white radius\">\n        <div class=\"user-photo\">\n          <img class=\"hide\" :src=\"profile.photo\" alt=\"\" @load=\"successLoadImg\" />\n        </div>\n        <div class=\"info\">\n          <div>\n            <h1>{{ profile.name }}</h1>\n            <span v-if=\"profile.name\"> {{ $filters.currency(followers.length) }} 人追蹤 </span>\n          </div>\n          <button\n            v-if=\"user._id !== profile._id && profile.name\"\n            :class=\"{ follow: follow }\"\n            class=\"btn border radius shadow fw-bold\"\n            type=\"button\"\n            @click=\"toggle(follow)\"\n          >\n            {{ follow ? '取消追蹤' : '追蹤' }}\n          </button>\n        </div>\n      </div>\n      <div class=\"mat border bg-white radius\"></div>\n    </div>\n    <SubNav />\n    <PostsNone v-if=\"posts.length == 0\" />\n    <Posts v-for=\"item in posts\" :key=\"item._id\" :tempPost=\"item\" />\n  </div>\n</template>\n\n<script>\nimport Posts from '@/components/Posts.vue'\nimport PostsNone from '@/components/PostsNone.vue'\nimport SubNav from '@/components/SubNav.vue'\n\nexport default {\n  name: 'ProfileView',\n  components: {\n    Posts,\n    PostsNone,\n    SubNav\n  },\n  data() {\n    return {\n      posts: {},\n      profile: {\n        _id: '',\n        photo: '',\n        name: '',\n        followers: []\n      }\n    }\n  },\n  mounted() {\n    this.getPosts()\n    this.getProfile()\n  },\n  watch: {\n    $route() {\n      if (this.$route.name === 'profile') {\n        this.posts = {}\n        this.getPosts()\n        this.getProfile()\n      }\n    }\n  },\n  computed: {\n    followers() {\n      const tempList = this.profile.followers\n      const followers = tempList.map((item) => Object.values(item)[0])\n      return followers\n    },\n    follow() {\n      return this.followers.includes(this.user._id)\n    },\n    user() {\n      const { user } = this.$store.state\n      return user\n    }\n  },\n  methods: {\n    getPosts() {\n      this.$store.commit('Load', true)\n      const tempQuery = { ...this.$route.query, ...this.$route.params }\n      let query = new URLSearchParams(tempQuery).toString()\n      if (query) query = `?${query}`\n      const api = `${process.env.VUE_APP_API}/posts${query}`\n      const { headers } = this.$store.state\n\n      this.$http\n        .get(api, headers)\n        .then((res) => {\n          this.posts = res.data.posts\n        })\n        .catch((err) => {\n          console.error(err)\n        })\n        .then(() => {\n          this.$store.commit('Load', false)\n        })\n    },\n    getProfile() {\n      this.$store.commit('Load', true)\n\n      const { p } = this.$route.params\n      const api = `${process.env.VUE_APP_API}/user/profile?p=${p}`\n      const { headers } = this.$store.state\n\n      this.$http\n        .get(api, headers)\n        .then((res) => {\n          const { user } = res.data\n          delete user.following\n          delete user.sex\n          if (user.photo === '') user.photo = `${process.env.VUE_APP_USER_PHOTO_2}`\n\n          this.profile = user\n        })\n        .catch((err) => {\n          console.error(err)\n        })\n        .then(() => {\n          this.$store.commit('Load', false)\n        })\n    },\n    toggle(follow) {\n      this.$store.commit('Load', true)\n\n      const { p } = this.$route.params\n      const api = `${process.env.VUE_APP_API}/user/${p}/follow`\n      const { headers } = this.$store.state\n      const method = follow ? this.$http.delete(api, headers) : this.$http.post(api, null, headers)\n\n      method\n        .then(() => {\n          this.getProfile()\n        })\n        .catch((err) => {\n          console.error(err)\n        })\n        .then(() => {\n          this.$store.commit('Load', false)\n        })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.profile {\n  display: grid;\n  grid-gap: 1rem;\n}\n\n.header-wrapper {\n  position: relative;\n\n  .header {\n    position: relative;\n    z-index: 1;\n    display: flex;\n    height: 5rem;\n\n    .user-photo {\n      width: 5rem;\n\n      border-right: 2px solid $black;\n      img {\n        width: 100%;\n        height: 100%;\n      }\n    }\n    .info {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      padding: 1rem;\n      width: 100%;\n      h1 {\n        font-size: 1rem;\n      }\n      .btn {\n        padding: 0.375rem 2rem;\n\n        background: $yellow;\n        &.follow {\n          background: $grey-light;\n        }\n        &:hover {\n          background: $blue-dark;\n\n          color: $white;\n        }\n      }\n    }\n  }\n  .mat {\n    position: absolute;\n    top: 5px;\n    left: -5px;\n    width: 100%;\n    height: 100%;\n  }\n}\n</style>\n\n","import { render } from \"./Profile.vue?vue&type=template&id=8b080748&scoped=true\"\nimport script from \"./Profile.vue?vue&type=script&lang=js\"\nexport * from \"./Profile.vue?vue&type=script&lang=js\"\n\nimport \"./Profile.vue?vue&type=style&index=0&id=8b080748&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\user\\\\Documents\\\\git\\\\metawall-front\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-8b080748\"]])\n\nexport default __exports__"],"names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","src","$data","photo","alt","onLoad","_ctx","_hoisted_6","name","currency","$options","length","_id","follow","type","onClick","_hoisted_8","_createVNode","_component_SubNav","_createBlock","_component_PostsNone","key","_Fragment","item","_component_Posts","tempPost","components","Posts","PostsNone","SubNav","data","posts","profile","followers","mounted","this","getPosts","getProfile","watch","$route","computed","tempList","map","Object","values","includes","user","$store","state","methods","commit","tempQuery","query","params","URLSearchParams","toString","api","headers","$http","get","then","res","catch","err","console","error","p","following","sex","toggle","method","delete","post","__exports__","render"],"sourceRoot":""}