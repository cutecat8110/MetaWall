{"version":3,"file":"js/674.cab447a6.js","mappings":"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","sources":["webpack://metawall/./src/views/Profile.vue","webpack://metawall/./src/views/Profile.vue?24e8"],"sourcesContent":["<template>\n  <div class=\"profile\">\n    <div class=\"header-wrapper\">\n      <div class=\"header border bg-white radius\">\n        <div class=\"user-photo\">\n          <img @load=\"successLoadImg\" :src=\"profile.photo\" alt=\"\" class=\"hide\" />\n        </div>\n        <div class=\"info\">\n          <div>\n            <h1>{{ profile.name }}</h1>\n            <span v-if=\"profile.name\"> {{ $filters.currency(followers.length) }} 人追蹤 </span>\n          </div>\n          <button\n            v-if=\"user._id !== profile._id && profile.name\"\n            type=\"button\"\n            class=\"btn border radius shadow fw-bold\"\n            :class=\"{ follow: follow }\"\n            @click=\"toggle(follow)\"\n          >\n            {{ follow ? '取消追蹤' : '追蹤' }}\n          </button>\n        </div>\n      </div>\n      <div class=\"mat border bg-white radius\"></div>\n    </div>\n    <SubNav />\n    <PostsNone v-if=\"posts.length == 0\" />\n    <Posts v-for=\"item in posts\" :key=\"item._id\" :tempPost=\"item\" />\n  </div>\n</template>\n\n<script>\nimport Posts from '@/components/Posts.vue';\nimport PostsNone from '@/components/PostsNone.vue';\nimport SubNav from '@/components/SubNav.vue';\n\nexport default {\n  name: 'ProfileView',\n  components: {\n    Posts,\n    PostsNone,\n    SubNav,\n  },\n  data() {\n    return {\n      posts: {},\n      profile: {\n        _id: '',\n        photo: '',\n        name: '',\n        followers: [],\n      },\n    };\n  },\n  mounted() {\n    this.getPosts();\n    this.getProfile();\n  },\n  watch: {\n    $route() {\n      if (this.$route.name === 'profile') {\n        this.posts = {};\n        this.getPosts();\n        this.getProfile();\n      }\n    },\n  },\n  computed: {\n    followers() {\n      const tempList = this.profile.followers;\n      const followers = tempList.map((item) => Object.values(item)[0]);\n      return followers;\n    },\n    follow() {\n      return this.followers.includes(this.user._id);\n    },\n    user() {\n      const { user } = this.$store.state;\n      return user;\n    },\n  },\n  methods: {\n    getPosts() {\n      this.$store.commit('Load', true);\n      const tempQuery = { ...this.$route.query, ...this.$route.params };\n      let query = new URLSearchParams(tempQuery).toString();\n      if (query) query = `?${query}`;\n      const api = `${process.env.VUE_APP_API}/posts${query}`;\n      const { headers } = this.$store.state;\n\n      this.$http\n        .get(api, headers)\n        .then((res) => {\n          this.posts = res.data.posts;\n        })\n        .catch((err) => {\n          console.error(err);\n        })\n        .then(() => {\n          this.$store.commit('Load', false);\n        });\n    },\n    getProfile() {\n      this.$store.commit('Load', true);\n\n      const { p } = this.$route.params;\n      const api = `${process.env.VUE_APP_API}/user/profile?p=${p}`;\n      const { headers } = this.$store.state;\n\n      this.$http\n        .get(api, headers)\n        .then((res) => {\n          const { user } = res.data;\n          delete user.following;\n          delete user.sex;\n          if (user.photo === '') user.photo = `${process.env.VUE_APP_USER_PHOTO_2}`;\n\n          this.profile = user;\n        })\n        .catch((err) => {\n          console.error(err);\n        })\n        .then(() => {\n          this.$store.commit('Load', false);\n        });\n    },\n    toggle(follow) {\n      this.$store.commit('Load', true);\n\n      const { p } = this.$route.params;\n      const api = `${process.env.VUE_APP_API}/user/${p}/follow`;\n      const { headers } = this.$store.state;\n      const method = follow ? this.$http.delete(api, headers) : this.$http.post(api, null, headers);\n\n      method\n        .then(() => {\n          this.getProfile();\n        })\n        .catch((err) => {\n          console.error(err);\n        })\n        .then(() => {\n          this.$store.commit('Load', false);\n        });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.profile {\n  display: grid;\n  grid-gap: 1rem;\n}\n\n.header-wrapper {\n  position: relative;\n\n  .header {\n    position: relative;\n    z-index: 1;\n    display: flex;\n    height: 5rem;\n\n    .user-photo {\n      width: 5rem;\n\n      border-right: 2px solid $black;\n      img {\n        width: 100%;\n        height: 100%;\n      }\n    }\n    .info {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      padding: 1rem;\n      width: 100%;\n      h1 {\n        font-size: 1rem;\n      }\n      .btn {\n        padding: 0.375rem 2rem;\n\n        background: $yellow;\n        &.follow {\n          background: $grey-light;\n        }\n        &:hover {\n          background: $blue-dark;\n\n          color: $white;\n        }\n      }\n    }\n  }\n  .mat {\n    position: absolute;\n    top: 5px;\n    left: -5px;\n    width: 100%;\n    height: 100%;\n  }\n}\n</style>\n","import { render } from \"./Profile.vue?vue&type=template&id=712caa16&scoped=true\"\nimport script from \"./Profile.vue?vue&type=script&lang=js\"\nexport * from \"./Profile.vue?vue&type=script&lang=js\"\n\nimport \"./Profile.vue?vue&type=style&index=0&id=712caa16&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\User\\\\Documents\\\\GitHub\\\\metawall\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-712caa16\"]])\n\nexport default __exports__"],"names":["class","_createElementVNode","_createElementBlock","onLoad","_ctx","src","$data","photo","alt","_toDisplayString","name","_hoisted_7","currency","$options","length","_id","type","follow","onClick","_hoisted_8","_createVNode","_component_SubNav","_createBlock","_component_PostsNone","key","_Fragment","_renderList","item","_component_Posts","tempPost","components","Posts","PostsNone","SubNav","data","posts","profile","followers","mounted","this","getPosts","getProfile","watch","$route","computed","tempList","map","Object","values","includes","user","$store","state","methods","commit","tempQuery","query","params","URLSearchParams","toString","api","headers","$http","get","then","res","catch","err","console","error","p","following","sex","toggle","method","delete","post","__exports__","render"],"sourceRoot":""}