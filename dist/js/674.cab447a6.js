"use strict";(self["webpackChunkmetawall"]=self["webpackChunkmetawall"]||[]).push([[674],{9104:function(t,e,s){s.r(e),s.d(e,{default:function(){return v}});var o=s(3396),r=s(7139);const a=t=>((0,o.dD)("data-v-712caa16"),t=t(),(0,o.Cn)(),t),i={class:"profile"},l={class:"header-wrapper"},h={class:"header border bg-white radius"},n={class:"user-photo"},c=["src"],p={class:"info"},u={key:0},d=a((()=>(0,o._)("div",{class:"mat border bg-white radius"},null,-1)));function m(t,e,s,a,m,f){const g=(0,o.up)("SubNav"),w=(0,o.up)("PostsNone"),$=(0,o.up)("Posts");return(0,o.wg)(),(0,o.iD)("div",i,[(0,o._)("div",l,[(0,o._)("div",h,[(0,o._)("div",n,[(0,o._)("img",{onLoad:e[0]||(e[0]=(...e)=>t.successLoadImg&&t.successLoadImg(...e)),src:m.profile.photo,alt:"",class:"hide"},null,40,c)]),(0,o._)("div",p,[(0,o._)("div",null,[(0,o._)("h1",null,(0,r.zw)(m.profile.name),1),m.profile.name?((0,o.wg)(),(0,o.iD)("span",u,(0,r.zw)(t.$filters.currency(f.followers.length))+" 人追蹤 ",1)):(0,o.kq)("",!0)]),f.user._id!==m.profile._id&&m.profile.name?((0,o.wg)(),(0,o.iD)("button",{key:0,type:"button",class:(0,r.C_)(["btn border radius shadow fw-bold",{follow:f.follow}]),onClick:e[1]||(e[1]=t=>f.toggle(f.follow))},(0,r.zw)(f.follow?"取消追蹤":"追蹤"),3)):(0,o.kq)("",!0)])]),d]),(0,o.Wm)(g),0==m.posts.length?((0,o.wg)(),(0,o.j4)(w,{key:0})):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(m.posts,(t=>((0,o.wg)(),(0,o.j4)($,{key:t._id,tempPost:t},null,8,["tempPost"])))),128))])}s(6699);var f=s(5939),g=s(5275),w=s(4365),$={name:"ProfileView",components:{Posts:f.Z,PostsNone:g.Z,SubNav:w.Z},data(){return{posts:{},profile:{_id:"",photo:"",name:"",followers:[]}}},mounted(){this.getPosts(),this.getProfile()},watch:{$route(){"profile"===this.$route.name&&(this.posts={},this.getPosts(),this.getProfile())}},computed:{followers(){const t=this.profile.followers,e=t.map((t=>Object.values(t)[0]));return e},follow(){return this.followers.includes(this.user._id)},user(){const{user:t}=this.$store.state;return t}},methods:{getPosts(){this.$store.commit("Load",!0);const t={...this.$route.query,...this.$route.params};let e=new URLSearchParams(t).toString();e&&(e=`?${e}`);const s=`https://agile-anchorage-83053.herokuapp.com/posts${e}`,{headers:o}=this.$store.state;this.$http.get(s,o).then((t=>{this.posts=t.data.posts})).catch((t=>{console.error(t)})).then((()=>{this.$store.commit("Load",!1)}))},getProfile(){this.$store.commit("Load",!0);const{p:t}=this.$route.params,e=`https://agile-anchorage-83053.herokuapp.com/user/profile?p=${t}`,{headers:s}=this.$store.state;this.$http.get(e,s).then((t=>{const{user:e}=t.data;delete e.following,delete e.sex,""===e.photo&&(e.photo="https://i.imgur.com/7HksMMW.jpg"),this.profile=e})).catch((t=>{console.error(t)})).then((()=>{this.$store.commit("Load",!1)}))},toggle(t){this.$store.commit("Load",!0);const{p:e}=this.$route.params,s=`https://agile-anchorage-83053.herokuapp.com/user/${e}/follow`,{headers:o}=this.$store.state,r=t?this.$http.delete(s,o):this.$http.post(s,null,o);r.then((()=>{this.getProfile()})).catch((t=>{console.error(t)})).then((()=>{this.$store.commit("Load",!1)}))}}},k=s(89);const _=(0,k.Z)($,[["render",m],["__scopeId","data-v-712caa16"]]);var v=_}}]);
//# sourceMappingURL=674.cab447a6.js.map