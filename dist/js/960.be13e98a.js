"use strict";(self["webpackChunkmetawall"]=self["webpackChunkmetawall"]||[]).push([[960],{1192:function(e,t,s){s.d(t,{Z:function(){return u}});var a=s(3396),o=s(7139);const r=e=>((0,a.dD)("data-v-2e84f518"),e=e(),(0,a.Cn)(),e),i={class:"title"},n={class:"border bg-white"},d=r((()=>(0,a._)("div",{class:"mat border bg-white"},null,-1)));function l(e,t,s,r,l,c){return(0,a.wg)(),(0,a.iD)("div",i,[(0,a._)("h1",n,(0,o.zw)(s.title),1),d])}var c={name:"TitleCMPT",props:["title"]},m=s(89);const p=(0,m.Z)(c,[["render",l],["__scopeId","data-v-2e84f518"]]);var u=p},2960:function(e,t,s){s.r(t),s.d(t,{default:function(){return D}});var a=s(3396),o=s(7139);const r=e=>((0,a.dD)("data-v-3f3d352b"),e=e(),(0,a.Cn)(),e),i={class:"post"},n={for:"content",class:"content-wrapper"},d=(0,a.Uk)("貼文內容 "),l={for:"uploadImage",class:"btn upload"},c=(0,a.Uk)(" 上傳圖片 "),m={class:"image-wrapper border radius"},p={key:0,class:"cover border cursor-none radius"},u=r((()=>(0,a._)("span",{class:"material-icons"}," image ",-1))),h=[u],g=["src"],b=r((()=>(0,a._)("span",{class:"material-icons"}," close ",-1))),f=[b],w=r((()=>(0,a._)("div",{class:"error-message"},"圖片格式錯誤，僅限 JPG、PNG 圖片",-1))),v={key:0,class:"error-message"},_={class:"submit-wrapper"},k=["disabled"];function $(e,t,s,r,u,b){const $=(0,a.up)("Title"),I=(0,a.up)("VField"),y=(0,a.up)("error-message"),P=(0,a.up)("VForm");return(0,a.wg)(),(0,a.iD)("div",i,[(0,a.Wm)($,{title:"張貼動態"}),(0,a.Wm)(P,{onSubmit:b.createPosts,class:"border bg-white radius"},{default:(0,a.w5)((({errors:s})=>[(0,a._)("label",n,[d,(0,a.Wm)(I,{id:"content",name:"內容",modelValue:u.content,"onUpdate:modelValue":t[0]||(t[0]=e=>u.content=e),placeholder:"輸入您的貼文內容",class:"content border",rules:"required",as:"textarea"},null,8,["modelValue"]),(0,a.Wm)(y,{name:"內容"})]),(0,a._)("label",l,[c,(0,a.Wm)(I,{id:"uploadImage",name:"uploadImage",type:"file",class:"hide",onChange:e=>b.upload(s),rules:{ext:["jpg","png","jpeg"]}},null,8,["onChange"])]),(0,a._)("div",m,[(0,a._)("div",{class:"clamp",style:(0,o.j5)(u.paddingBottom)},[u.image?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",p,h)),u.image?((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(0,a._)("img",{ref:"postsPhoto",onLoad:t[1]||(t[1]=t=>(e.successLoadImg,b.size())),src:u.image,alt:"",class:"hide"},null,40,g),(0,a._)("button",{type:"button",class:"btn border clear circle",onClick:t[2]||(t[2]=(...e)=>b.clearImg&&b.clearImg(...e))},f)],64)):(0,a.kq)("",!0)],4)]),(0,a.Wm)(y,{name:"uploadImage"},{default:(0,a.w5)((()=>[w])),_:1}),u.errMessage?((0,a.wg)(),(0,a.iD)("div",v,(0,o.zw)(u.errMessage),1)):(0,a.kq)("",!0),(0,a._)("div",_,[(0,a._)("button",{type:"submit",class:"btn border submit",disabled:b.disabled(s)}," 送出貼文 ",8,k)])])),_:1},8,["onSubmit"])])}var I=s(1192),y={name:"PostView",components:{Title:I.Z},data(){return{content:"",image:"",err:!0,errMessage:"",paddingBottom:{}}},methods:{createPosts(){this.$store.commit("Load",!0);const e="https://agile-anchorage-83053.herokuapp.com/post",{headers:t}=this.$store.state,s={user:this.$store.state.user._id,image:this.image,content:this.content};this.$http.post(e,s,t).then((()=>{this.$router.push({name:"posts_wall"})})).catch((e=>{console.error(e)})).then((()=>{this.$store.commit("Load",!1)}))},async upload(e){if(this.errMessage="",this.image="",void 0===e.uploadImage){this.$store.commit("Load",!0);const e=document.getElementById("uploadImage").files[0],t=new FormData;t.append("file-to-upload",e);const s="https://agile-anchorage-83053.herokuapp.com/upload/post",{headers:a}=this.$store.state;this.$http.post(s,t,a).then((e=>{const{imgUrl:t}=e.data;this.image=t})).catch((e=>{this.errMessage=e.response.data.message})).then((()=>{this.$store.commit("Load",!1)}))}},clearImg(){this.image="",this.paddingBottom={paddingBottom:"52.35%"}},disabled(e){const t=Object.keys(e).length;return!this.content||0!==t},size(){if(this.$refs.postsPhoto){const{height:e}=this.$refs.postsPhoto,{width:t}=this.$refs.postsPhoto,s=e/t*100;this.paddingBottom={paddingBottom:s>150?"150%":`${s}%`}}}}},P=s(89);const C=(0,P.Z)(y,[["render",$],["__scopeId","data-v-3f3d352b"]]);var D=C}}]);
//# sourceMappingURL=960.be13e98a.js.map