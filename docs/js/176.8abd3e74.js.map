{"version":3,"file":"js/176.8abd3e74.js","mappings":"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","sources":["webpack://metawall/./src/views/Account.vue","webpack://metawall/./src/views/Account.vue?727f"],"sourcesContent":["<template>\n  <div class=\"account\">\n    <VForm v-slot=\"{ errors }\" @submit=\"updated\">\n      <!-- 頭像 -->\n      <div class=\"user-photo border circle\">\n        <img class=\"hide\" :src=\"user.photo\" alt=\"\" @load=\"successLoadImg\" />\n      </div>\n      <!-- 上傳按鈕 -->\n      <div class=\"upload-wrapper\">\n        <label class=\"upload btn radius\" for=\"uploadImage\">\n          上傳大頭照\n          <VField\n            id=\"uploadImage\"\n            class=\"hide\"\n            name=\"uploadImage\"\n            type=\"file\"\n            :rules=\"{ ext: ['jpg', 'png', 'jpeg'] }\"\n            @change=\"upload(errors)\"\n          />\n        </label>\n        <error-message name=\"uploadImage\">\n          <div class=\"error-message\">圖片格式錯誤，僅限 JPG、PNG 圖片</div>\n        </error-message>\n        <div v-if=\"errMessage\" class=\"error-message\">{{ errMessage }}</div>\n      </div>\n      <!-- 暱稱 -->\n      <label class=\"name-wrapper\" for=\"name\">\n        <div class=\"title\">暱稱</div>\n        <VField\n          id=\"name\"\n          v-model=\"user.name\"\n          class=\"name border\"\n          name=\"暱稱\"\n          placeholder=\"輸入您的暱稱\"\n          :rules=\"{ required: true, min: 2, max: 13 }\"\n        />\n        <error-message class=\"error-message\" name=\"暱稱\" />\n      </label>\n      <!-- 性別 -->\n      <div class=\"sex-wrapper\">\n        <div class=\"title\">性別</div>\n        <label class=\"radio-wrapper\" for=\"male\">\n          <input id=\"male\" v-model=\"user.sex\" class=\"radio\" type=\"radio\" value=\"male\" />\n          <span class=\"radio-button\"></span>\n          男性\n        </label>\n        <label class=\"radio-wrapper\" for=\"female\">\n          <input id=\"female\" v-model=\"user.sex\" class=\"radio\" type=\"radio\" value=\"female\" />\n          <span class=\"radio-button\"></span>\n          女性\n        </label>\n      </div>\n      <!-- 送出按鈕 -->\n      <button class=\"btn border submit\" type=\"submit\" :disabled=\"disabled(errors)\">送出更新</button>\n    </VForm>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'AccountView',\n  data() {\n    return {\n      user: {\n        photo: '',\n        name: '',\n        sex: ''\n      },\n      errMessage: ''\n    }\n  },\n  computed: {\n    tempUser() {\n      const { user } = this.$store.state\n      return user\n    },\n    compare() {\n      const { tempUser } = this\n      const { user } = this\n      const compare = [\n        user.photo !== tempUser.photo,\n        user.name !== tempUser.name,\n        user.sex !== tempUser.sex\n      ].includes(true)\n      return compare\n    }\n  },\n  watch: {\n    tempUser: {\n      handler() {\n        const user = this.tempUser\n        this.user = {\n          photo: user.photo,\n          name: user.name,\n          sex: user.sex || 'male'\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  },\n  methods: {\n    async upload(errors) {\n      this.errMessage = ''\n      if (errors.uploadImage === undefined) {\n        this.$store.commit('Load', true)\n        const uploadedFile = document.getElementById('uploadImage').files[0]\n        const formData = new FormData()\n        formData.append('file-to-upload', uploadedFile)\n        const api = `${process.env.VUE_APP_API}/upload/avatar`\n        const { headers } = this.$store.state\n        this.$http\n          .post(api, formData, headers)\n          .then((res) => {\n            const { imgUrl } = res.data\n            this.user.photo = imgUrl\n          })\n          .catch((err) => {\n            this.errMessage = err.response.data.message\n          })\n          .then(() => {\n            this.$store.commit('Load', false)\n          })\n      }\n    },\n    updated() {\n      this.$store.commit('Load', true)\n      const api = `${process.env.VUE_APP_API}/user/profile`\n      const { headers } = this.$store.state\n      const data = {}\n      const { tempUser } = this\n      const newUser = this.user\n      if (newUser.name !== tempUser.name) data.name = newUser.name\n      if (\n        // eslint-disable-next-line operator-linebreak\n        newUser.photo !== tempUser.photo &&\n        newUser.photo !== `${process.env.VUE_APP_USER_PHOTO}`\n      ) {\n        data.photo = newUser.photo\n      }\n      if (newUser.sex !== tempUser.sex) data.sex = newUser.sex\n\n      this.$http\n        .patch(api, data, headers)\n        .then((res) => {\n          const { user } = res.data\n          delete user.followers\n          delete user.following\n          if (user.photo === '') user.photo = `${process.env.VUE_APP_USER_PHOTO}`\n\n          this.$store.commit('user', user)\n          this.$swal({\n            title: '資料已更新',\n            icon: 'success',\n            customClass: {\n              actions: 'customize',\n              icon: 'customize'\n            }\n          })\n        })\n        .catch((err) => {\n          console.error(err)\n        })\n        .then(() => {\n          this.$store.commit('Load', false)\n        })\n    },\n    disabled(errors) {\n      const err = Object.keys(errors).length\n      if (this.user.name && err === 0 && this.compare) return false\n      return true\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.user-photo {\n  margin: 0 auto 1rem auto;\n  width: 6.75rem;\n  height: 6.75rem;\n}\n\n.upload-wrapper {\n  margin-bottom: 1rem;\n  .error-message {\n    text-align: center;\n  }\n}\n\n.upload {\n  margin: 0 auto;\n  padding: 0.25rem 2rem;\n  width: fit-content;\n\n  background: $black;\n\n  color: $white;\n  line-height: 1.5em;\n  &:hover {\n    background: $blue-dark;\n  }\n}\n\n.title {\n  margin-bottom: 0.25rem;\n}\n\n.name-wrapper {\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 1rem;\n  .border {\n    padding: 0.75rem 1rem;\n  }\n}\n\n.sex-wrapper {\n  margin-bottom: 2rem;\n}\n\n.radio-wrapper {\n  display: inline-flex;\n  align-items: center;\n  &:not(:last-child) {\n    margin-right: 1.5rem;\n  }\n}\n\n.radio {\n  display: none;\n  &:checked ~ .radio-button::after {\n    opacity: 1;\n  }\n}\n\n.radio-button {\n  position: relative;\n  margin-right: 0.75rem;\n  width: 1.25rem;\n  height: 1.25rem;\n\n  border: 2px solid $black;\n  border-radius: 50%;\n}\n\n.radio-button::after {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  display: block;\n  width: 0.625rem;\n  height: 0.625rem;\n\n  border-radius: 50%;\n  background-color: $black;\n\n  content: '';\n\n  opacity: 0;\n  transition: $transition-1;\n  transform: translate(-50%, -50%);\n}\n\n.error-message {\n  margin-top: 0.25rem;\n\n  color: $pink;\n  text-align: start;\n\n  font-size: 0.875rem;\n}\n</style>\n\n","import { render } from \"./Account.vue?vue&type=template&id=aa62ae98&scoped=true\"\nimport script from \"./Account.vue?vue&type=script&lang=js\"\nexport * from \"./Account.vue?vue&type=script&lang=js\"\n\nimport \"./Account.vue?vue&type=style&index=0&id=aa62ae98&lang=scss&scoped=true\"\n\nimport exportComponent from \"C:\\\\Users\\\\user\\\\Documents\\\\git\\\\metawall-front\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-aa62ae98\"]])\n\nexport default __exports__"],"names":["class","for","_createElementVNode","_createElementBlock","_hoisted_1","_createVNode","_component_VForm","onSubmit","$options","errors","_hoisted_2","src","$data","photo","alt","onLoad","_ctx","_hoisted_4","_hoisted_5","_component_VField","id","name","type","rules","ext","onChange","_component_error_message","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","placeholder","required","min","max","_hoisted_11","_hoisted_12","_hoisted_13","sex","value","_hoisted_14","_hoisted_16","_hoisted_17","disabled","data","user","errMessage","computed","tempUser","this","$store","state","compare","includes","watch","handler","deep","immediate","methods","upload","undefined","uploadImage","commit","uploadedFile","document","getElementById","files","formData","FormData","append","api","headers","$http","post","then","res","imgUrl","catch","err","response","message","updated","newUser","patch","followers","following","$swal","title","icon","customClass","actions","console","error","Object","keys","length","__exports__","render"],"sourceRoot":""}