"use strict";(self["webpackChunkmetawall"]=self["webpackChunkmetawall"]||[]).push([[304],{7798:function(t,e,s){s.r(e),s.d(e,{default:function(){return v}});var o=s(6768),r=s(4232);const l=t=>((0,o.Qi)("data-v-8b080748"),t=t(),(0,o.jt)(),t),a={class:"profile"},i={class:"header-wrapper"},n={class:"header border bg-white radius"},h={class:"user-photo"},c=["src"],d={class:"info"},u={key:0},p=l((()=>(0,o.Lk)("div",{class:"mat border bg-white radius"},null,-1)));function m(t,e,s,l,m,f){const g=(0,o.g2)("SubNav"),w=(0,o.g2)("PostsNone"),$=(0,o.g2)("Posts");return(0,o.uX)(),(0,o.CE)("div",a,[(0,o.Lk)("div",i,[(0,o.Lk)("div",n,[(0,o.Lk)("div",h,[(0,o.Lk)("img",{class:"hide",src:m.profile.photo,alt:"",onLoad:e[0]||(e[0]=(...e)=>t.successLoadImg&&t.successLoadImg(...e))},null,40,c)]),(0,o.Lk)("div",d,[(0,o.Lk)("div",null,[(0,o.Lk)("h1",null,(0,r.v_)(m.profile.name),1),m.profile.name?((0,o.uX)(),(0,o.CE)("span",u,(0,r.v_)(t.$filters.currency(f.followers.length))+" 人追蹤 ",1)):(0,o.Q3)("",!0)]),f.user._id!==m.profile._id&&m.profile.name?((0,o.uX)(),(0,o.CE)("button",{key:0,class:(0,r.C4)([{follow:f.follow},"btn border radius shadow fw-bold"]),type:"button",onClick:e[1]||(e[1]=t=>f.toggle(f.follow))},(0,r.v_)(f.follow?"取消追蹤":"追蹤"),3)):(0,o.Q3)("",!0)])]),p]),(0,o.bF)(g),0==m.posts.length?((0,o.uX)(),(0,o.Wv)(w,{key:0})):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(m.posts,(t=>((0,o.uX)(),(0,o.Wv)($,{key:t._id,tempPost:t},null,8,["tempPost"])))),128))])}var f=s(2587),g=s(6678),w=s(5752),$={name:"ProfileView",components:{Posts:f.A,PostsNone:g.A,SubNav:w.A},data(){return{posts:{},profile:{_id:"",photo:"",name:"",followers:[]}}},mounted(){this.getPosts(),this.getProfile()},watch:{$route(){"profile"===this.$route.name&&(this.posts={},this.getPosts(),this.getProfile())}},computed:{followers(){const t=this.profile.followers,e=t.map((t=>Object.values(t)[0]));return e},follow(){return this.followers.includes(this.user._id)},user(){const{user:t}=this.$store.state;return t}},methods:{getPosts(){this.$store.commit("Load",!0);const t={...this.$route.query,...this.$route.params};let e=new URLSearchParams(t).toString();e&&(e=`?${e}`);const s=`https://metawall-backend-c89d.onrender.com/posts${e}`,{headers:o}=this.$store.state;this.$http.get(s,o).then((t=>{this.posts=t.data.posts})).catch((t=>{console.error(t)})).then((()=>{this.$store.commit("Load",!1)}))},getProfile(){this.$store.commit("Load",!0);const{p:t}=this.$route.params,e=`https://metawall-backend-c89d.onrender.com/user/profile?p=${t}`,{headers:s}=this.$store.state;this.$http.get(e,s).then((t=>{const{user:e}=t.data;delete e.following,delete e.sex,""===e.photo&&(e.photo="https://i.imgur.com/7HksMMW.jpg"),this.profile=e})).catch((t=>{console.error(t)})).then((()=>{this.$store.commit("Load",!1)}))},toggle(t){this.$store.commit("Load",!0);const{p:e}=this.$route.params,s=`https://metawall-backend-c89d.onrender.com/user/${e}/follow`,{headers:o}=this.$store.state,r=t?this.$http.delete(s,o):this.$http.post(s,null,o);r.then((()=>{this.getProfile()})).catch((t=>{console.error(t)})).then((()=>{this.$store.commit("Load",!1)}))}}},k=s(1241);const b=(0,k.A)($,[["render",m],["__scopeId","data-v-8b080748"]]);var v=b}}]);
//# sourceMappingURL=304.70d5b50f.js.map